(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.SolidClient = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";module.exports={authEndpoint:"https://databox.me/",parser:"rdflib",proxyUrl:"https://databox.me/,proxy?uri={uri}",signupEndpoint:"https://solid.github.io/solid-idps/",signupWindowHeight:600,signupWindowWidth:1024,timeout:5e4};
},{}],2:[function(require,module,exports){
"use strict";function currentUser(){if("undefined"==typeof window)return null;var n=window.location.href;return login(n)["catch"](function(n){return null})}function listen(){var n=new Promise(function(n,e){var i=window.addEventListener?"addEventListener":"attachEvent",t=window[i],r="attachEvent"===i?"onmessage":"message";t(r,function(i){var t=i.data;if("User:"===t.slice(0,5)){var r=t.slice(5,t.length);return r&&r.length>0&&"http"===r.slice(0,4)?n(r):e(r)}},!0)});return n}function login(n,e){var i=require("../config").authEndpoint;return n=n||window.location.origin+window.location.pathname,e=e||i,webClient.head(n).then(function(n){return n.isLoggedIn()?n.user:webClient.head(e).then(function(n){return n.user})})}function signup(n){var e=require("../config");n=n||e.signupEndpoint;var i=e.signupWindowWidth,t=e.signupWindowHeight,r=window.screen.width/2-(i/2+10),o=window.screen.height/2-(t/2+50),u="Solid signup",s=n+"?origin="+encodeURIComponent(window.location.origin),c="resizable,scrollbars,status,width="+i+",height="+t+",left="+r+",top="+o;return window.open(s,u,c),new Promise(function(n,e){listen().then(function(e){return n(e)})["catch"](function(n){return e(n)})})}module.exports.currentUser=currentUser,module.exports.listen=listen,module.exports.login=login,module.exports.signup=signup;var webClient=require("./web");
},{"../config":1,"./web":22}],3:[function(require,module,exports){
"use strict";function discoverWebID(e){return new Promise(function(r,t){webClient.options(e).then(function(o){var i=o.meta;if(!i)throw new Error("Could not find a meta URL in the Link header");i=webUtil.absoluteUrl(i,e),webClient.getParsedGraph(i).then(function(t){var o=t.any(void 0,vocab.solid("account"));if(!o||!o.uri)throw new Error("Could not find a WebID matching the domain "+e);r(o.uri)})["catch"](function(e){t(e)})})["catch"](function(e){t(e)})})}function getProfile(e,r){return r=r||{},r.headers=r.headers||{Accept:"text/turtle"},r.noCredentials=!0,webClient.get(e,r).then(function(t){var o=t.contentType();if(!o)throw new Error("Cannot parse profile without a Content-Type: header");var i=graphUtil.parseGraph(e,t.raw(),o),n=new SolidProfile(e,i,t);return n.isLoaded=!0,r.ignoreExtended?n:loadExtendedProfile(n,r)})}function loadExtendedProfile(e,r){var t=e.relatedProfilesLinks();return webClient.loadParsedGraphs(t,r).then(function(r){return r.forEach(function(r){r&&r.value&&e.appendFromGraph(r.value,r.uri)}),e})}module.exports.discoverWebID=discoverWebID,module.exports.getProfile=getProfile,module.exports.loadExtendedProfile=loadExtendedProfile;var graphUtil=require("./util/graph-util"),webUtil=require("./util/web-util"),webClient=require("./web"),SolidProfile=require("./solid/profile"),vocab=require("./vocab");
},{"./solid/profile":10,"./util/graph-util":15,"./util/web-util":19,"./vocab":21,"./web":22}],4:[function(require,module,exports){
"use strict";var lib=require("../package");module.exports.version=function(){return lib.version};
},{"../package":29}],5:[function(require,module,exports){
"use strict";function Authorization(t,i){this.accessModes={},this.agent=null,this.group=null,this.inherited=i,this.mailTo=[],this.originsAllowed={},this.resourceUrl=t}function addMailTo(t){"string"!=typeof t&&(t=t.object.uri),t.startsWith("mailto:")&&(t=t.split(":")[1]),this.mailTo.push(t),this.mailTo.sort()}function addMode(t){var i=this;return Array.isArray(t)?t.forEach(function(t){i.addModeSingle(t)}):i.addModeSingle(t),i}function addModeSingle(t){return"string"!=typeof t&&(t=t.object.uri),this.accessModes[t]=!0,this}function addOrigin(t){var i=this;return Array.isArray(t)?t.forEach(function(t){i.addOriginSingle(t)}):i.addOriginSingle(t),i}function addOriginSingle(t){return"string"!=typeof t&&(t=t.object.uri),this.originsAllowed[t]=!0,this}function allModes(){return Object.keys(this.accessModes)}function allOrigins(){return Object.keys(this.originsAllowed)}function allowsOrigin(t){return t in this.originsAllowed}function allowsRead(){return this.accessModes[acl.READ]}function allowsWrite(){return this.accessModes[acl.WRITE]}function allowsAppend(){return this.accessModes[acl.APPEND]||this.accessModes[acl.WRITE]}function allowsControl(){return this.accessModes[acl.CONTROL]}function equals(t){var i=this.agent===t.agent,o=this.group===t.group,r=this.resourceUrl===t.resourceUrl,e=Object.keys(this.accessModes),n=Object.keys(t.accessModes),s=e.length===n.length,a=JSON.stringify(this.inherited)===JSON.stringify(t.inherited),h=!0;e.forEach(function(i){t.accessModes[i]||(h=!1)});var u=JSON.stringify(this.mailTo)===JSON.stringify(t.mailTo),l=JSON.stringify(this.originsAllowed)===JSON.stringify(t.originsAllowed);return i&&o&&r&&s&&h&&a&&u&&l}function hashFragment(){if(!this.webId||!this.resourceUrl)throw new Error("Cannot call hashFragment() on an incomplete authorization");var t=hashFragmentFor(this.webId(),this.resourceUrl);return t}function isAgent(){return this.agent}function isEmpty(){return 0===Object.keys(this.accessModes).length}function isPublic(){return this.group===acl.EVERYONE}function isGroup(){return this.group}function isInherited(){return this.inherited}function isValid(){return this.webId()&&this.resourceUrl&&!this.isEmpty()}function mergeWith(t){if(this.hashFragment()!==t.hashFragment())throw new Error("Cannot merge authorizations with different agent id or resource url (accessTo)");for(var i in t.accessModes)this.addMode(i)}function rdfStatements(){if(!this.webId()||!this.resourceUrl)return[];var t,i=rdf.sym("#"+this.hashFragment()),o=[rdf.st(i,vocab.rdf("type"),vocab.acl("Authorization"))];this.agent&&(t=rdf.st(i,vocab.acl("agent"),rdf.sym(this.agent)),o.push(t)),this.mailTo.length>0&&this.mailTo.forEach(function(r){t=rdf.st(i,vocab.acl("agent"),rdf.sym("mailto:"+r)),o.push(t)}),this.group&&(t=rdf.st(i,vocab.acl("agentClass"),rdf.sym(this.group)),o.push(t)),t=rdf.st(i,vocab.acl("accessTo"),rdf.sym(this.resourceUrl)),o.push(t);var r=Object.keys(this.accessModes);return r.forEach(function(r){t=rdf.st(i,vocab.acl("mode"),rdf.sym(r)),o.push(t)}),this.inherited&&(t=rdf.st(i,vocab.acl("defaultForNew"),rdf.sym(this.resourceUrl)),o.push(t)),this.allOrigins().forEach(function(r){t=rdf.st(i,vocab.acl("origin"),rdf.sym(r)),o.push(t)}),o}function removeMode(t){var i=this;return Array.isArray(t)?t.forEach(function(t){i.removeModeSingle(t)}):i.removeModeSingle(t),i}function removeModeSingle(t){"string"!=typeof t&&(t=t.object.uri),delete this.accessModes[t]}function removeOrigin(t){var i=this;return Array.isArray(t)?t.forEach(function(t){i.removeOriginSingle(t)}):i.removeOriginSingle(t),i}function removeOriginSingle(t){"string"!=typeof t&&(t=t.object.uri),delete this.originsAllowed[t]}function setAgent(t){if("string"!=typeof t&&(t=t.object.uri),t===acl.EVERYONE)this.setPublic();else if(this.group)throw new Error("Cannot set agent, authorization already has a group set");t.startsWith("mailto:")?this.addMailTo(t):this.agent=t}function setGroup(t){if("string"!=typeof t&&(t=t.object.uri),this.agent)throw new Error("Cannot set group, authorization already has an agent set");this.group=t}function setPublic(){this.setGroup(acl.EVERYONE)}function webId(){return this.agent||this.group}function hashFragmentFor(t,i){var o=t+"-"+i;return hash.unique(o)}var hash=require("shorthash"),vocab=require("../vocab"),rdf=require("../util/rdf-parser").rdflib,acl={READ:vocab.acl("Read").uri,WRITE:vocab.acl("Write").uri,APPEND:vocab.acl("Append").uri,CONTROL:vocab.acl("Control").uri,EVERYONE:vocab.foaf("Agent").uri},INHERIT=!0;Authorization.prototype.addMailTo=addMailTo,Authorization.prototype.addMode=addMode,Authorization.prototype.addModeSingle=addModeSingle,Authorization.prototype.addOrigin=addOrigin,Authorization.prototype.addOriginSingle=addOriginSingle,Authorization.prototype.allModes=allModes,Authorization.prototype.allOrigins=allOrigins,Authorization.prototype.allowsOrigin=allowsOrigin,Authorization.prototype.allowsRead=allowsRead,Authorization.prototype.allowsWrite=allowsWrite,Authorization.prototype.allowsAppend=allowsAppend,Authorization.prototype.allowsControl=allowsControl,Authorization.prototype.equals=equals,Authorization.prototype.hashFragment=hashFragment,Authorization.prototype.isAgent=isAgent,Authorization.prototype.isEmpty=isEmpty,Authorization.prototype.isPublic=isPublic,Authorization.prototype.isGroup=isGroup,Authorization.prototype.isInherited=isInherited,Authorization.prototype.isValid=isValid,Authorization.prototype.mergeWith=mergeWith,Authorization.prototype.rdfStatements=rdfStatements,Authorization.prototype.removeMode=removeMode,Authorization.prototype.removeModeSingle=removeModeSingle,Authorization.prototype.removeOrigin=removeOrigin,Authorization.prototype.removeOriginSingle=removeOriginSingle,Authorization.prototype.setAgent=setAgent,Authorization.prototype.setGroup=setGroup,Authorization.prototype.setPublic=setPublic,Authorization.prototype.webId=webId,module.exports=Authorization,module.exports.acl=acl,module.exports.INHERIT=INHERIT,module.exports.hashFragmentFor=hashFragmentFor;
},{"../util/rdf-parser":16,"../vocab":21,"shorthash":24}],6:[function(require,module,exports){
"use strict";function clearPermissions(e){var r;return webClient.head(e).then(function(e){if(r=e.aclAbsoluteUrl(),!r)throw new Error("ACL URL not found for resource.");return webClient.del(r)})}function getPermissions(e){var r,n;return webClient.head(e).then(function(i){if(r=i.aclAbsoluteUrl(),!r)throw new Error("ACL URL not found for resource.");return n=new PermissionSet(e,r,i.isContainer()),webClient.getParsedGraph(r)}).then(function(e){return n.initFromGraph(e),n})}var PermissionSet=require("./permission-set"),webClient=require("../web");module.exports.clearPermissions=clearPermissions,module.exports.getPermissions=getPermissions;
},{"../web":22,"./permission-set":7}],7:[function(require,module,exports){
"use strict";function PermissionSet(t,i,r){this.authorizations={},this.resourceUrl=t,this.aclUrl=i,this.resourceType=r?CONTAINER:RESOURCE}function addAuthorization(t){var i=t.hashFragment();return i in this.authorizations?this.authorizations[i].mergeWith(t):this.authorizations[i]=t,this}function addGroupPermission(t,i){var r=new Authorization(this.resourceUrl,this.isAuthInherited());return r.setGroup(t),r.addMode(i),this.addAuthorization(r),this}function addPermission(t,i,r){if(!t)throw new Error("addPermission() requires a valid webId");if(!i)throw new Error("addPermission() requires a valid accessMode");var o=new Authorization(this.resourceUrl,this.isAuthInherited());return o.setAgent(t),o.addMode(i),r&&o.addOrigin(r),this.addAuthorization(o),this}function allAuthorizations(){var t,i=[],r=this;return Object.keys(this.authorizations).forEach(function(o){t=r.authorizations[o],i.push(t)}),i}function buildGraph(){var t=rdf.graph();return this.allAuthorizations().forEach(function(i){t.add(i.rdfStatements())}),t}function clear(){var t=this.aclUrl;return t?webClient.del(t):Promise.reject(new Error("Cannot clear - unknown target url"))}function count(){return Object.keys(this.authorizations).length}function equals(t){var i=this,r=this.resourceUrl===t.resourceUrl,o=this.aclUrl===t.aclUrl,e=this.resourceType===t.resourceType,n=Object.keys(this.authorizations),s=Object.keys(t.authorizations);if(n.length!==s.length)return!1;var a,u,h=!0;return n.forEach(function(r){a=i.authorizations[r],u=t.authorizations[r],u||(h=!1),a.equals(u)||(h=!1)}),r&&o&&e&&h}function forEach(t){var i=this;this.allAuthorizations().forEach(function(r){t.call(i,r)})}function initFromGraph(t){var i,r,o,e,n,s,a,u,h,c=t.statementsMatching(null,null,vocab.acl("Authorization")),l=this;c.forEach(function(c){i=c.subject,r=t.statementsMatching(i,vocab.acl("agent")),o=r.filter(isMailTo),r=r.filter(function(t){return!isMailTo(t)}),e=t.statementsMatching(i,vocab.acl("agentClass")),n=t.statementsMatching(i,vocab.acl("accessTo")),a=t.statementsMatching(i,vocab.acl("mode")),u=t.statementsMatching(i,vocab.acl("origin")),h=t.any(i,vocab.acl("defaultForNew"))||t.any(i,vocab.acl("default")),r.forEach(function(t){n.forEach(function(i){s=new Authorization(i.object.uri,h),s.setAgent(t),s.addMode(a),s.addOrigin(u),o.forEach(function(t){s.addMailTo(t)}),l.addAuthorization(s)})}),e.forEach(function(t){n.forEach(function(i){s=new Authorization(i.object.uri,h),s.setGroup(t),s.addMode(a),s.addOrigin(u),l.addAuthorization(s)})})})}function isAuthInherited(){return this.resourceType===CONTAINER}function isEmpty(){return 0===this.count()}function permissionFor(t,i){if(!t)return null;i=i||this.resourceUrl;var r=Authorization.hashFragmentFor(t,i);return this.authorizations[r]}function removeAuthorization(t){var i=t.hashFragment();return delete this.authorizations[i],this}function removePermission(t,i){var r=this.permissionFor(t,this.resourceUrl);return r?(r.removeMode(i),r.isEmpty()&&this.removeAuthorization(r),this):this}function save(t){return t=t||this.aclUrl,t?webClient.put(t,this.serialize()):Promise.reject(new Error("Cannot save - unknown target url"))}function serialize(t){t=t||"text/turtle";var i=this.buildGraph(),r=null,o=null;return new Promise(function(e,n){rdf.serialize(r,i,o,t,function(i,r){return i?n(i):r?void e(r):n(new Error("Error serializing the graph to "+t))})})}function isMailTo(t){return"string"==typeof t?t.startsWith("mailto:"):t.object.uri.startsWith("mailto:")}var Authorization=require("./authorization"),vocab=require("./../vocab"),rdf=require("../util/rdf-parser").rdflib,webClient=require("../web"),RESOURCE="resource",CONTAINER="container";PermissionSet.prototype.addAuthorization=addAuthorization,PermissionSet.prototype.addGroupPermission=addGroupPermission,PermissionSet.prototype.addPermission=addPermission,PermissionSet.prototype.allAuthorizations=allAuthorizations,PermissionSet.prototype.buildGraph=buildGraph,PermissionSet.prototype.clear=clear,PermissionSet.prototype.count=count,PermissionSet.prototype.equals=equals,PermissionSet.prototype.forEach=forEach,PermissionSet.prototype.initFromGraph=initFromGraph,PermissionSet.prototype.isAuthInherited=isAuthInherited,PermissionSet.prototype.isEmpty=isEmpty,PermissionSet.prototype.permissionFor=permissionFor,PermissionSet.prototype.removeAuthorization=removeAuthorization,PermissionSet.prototype.removePermission=removePermission,PermissionSet.prototype.save=save,PermissionSet.prototype.serialize=serialize,module.exports=PermissionSet,module.exports.RESOURCE=RESOURCE,module.exports.CONTAINER=CONTAINER,module.exports.isMailTo=isMailTo;
},{"../util/rdf-parser":16,"../web":22,"./../vocab":21,"./authorization":5}],8:[function(require,module,exports){
"use strict";function SolidContainer(r,e){SolidResource.call(this,r,e),this.containers={},this.contentsUris=[],this.resources={},e&&this.initFromResponse(this.uri,e)}module.exports=SolidContainer;var rdf=require("../util/rdf-parser").rdflib,graphUtil=require("../util/graph-util"),parseLinks=graphUtil.parseLinks,vocab=require("../vocab"),SolidResource=require("./resource");SolidContainer.prototype=Object.create(SolidResource.prototype),SolidContainer.prototype.constructor=SolidContainer,SolidContainer.prototype.appendFromGraph=function(r,e){this.types=Object.keys(r.findTypeURIs(rdf.sym(this.uri)));var t=parseLinks(r,null,vocab.ldp("contains"));this.contentsUris=this.contentsUris.concat(t.sort());var i,o=r.each(null,null,vocab.ldp("Container")),n=this;o.forEach(function(e){e.uri!==n.uri&&(i=new SolidContainer(e.uri),i.types=Object.keys(r.findTypeURIs(e)),n.containers[i.uri]=i)});var s,a,p;t.forEach(function(e){a=e in n.containers,s=e!==n.uri&&!a,s&&(p=new SolidResource(e),p.types=Object.keys(r.findTypeURIs(rdf.sym(e))),n.resources[e]=p)})},SolidContainer.prototype.findByType=function(r){var e,t,i=[];for(e in this.containers)t=this.containers[e],t.isType(r)&&i.push(t);var o;for(e in this.resources)o=this.resources[e],o.isType(r)&&i.push(o);return i},SolidContainer.prototype.initFromResponse=function(r,e){var t=e.contentType();if(!t)throw new Error("Cannot parse container without a Content-Type: header");var i=graphUtil.parseGraph(r,e.raw(),t);this.parsedGraph=i,this.appendFromGraph(i,r)},SolidResource.prototype.isContainer=function(){return!0},SolidContainer.prototype.isEmpty=function(){return 0===this.contentsUris.length};
},{"../util/graph-util":15,"../util/rdf-parser":16,"../vocab":21,"./resource":11}],9:[function(require,module,exports){
"use strict";function IndexRegistration(t,i,n,e,o){this.isListed=o,this.locationType=n,this.locationUri=e,this.rdfClass=i,this.registrationUri=t}module.exports=IndexRegistration,IndexRegistration.prototype.isContainer=function(){return"container"===this.locationType},IndexRegistration.prototype.isInstance=function(){return"instance"===this.locationType};
},{}],10:[function(require,module,exports){
"use strict";function SolidProfile(e,i,r){this.inbox={uri:null,graph:null},this.isLoaded=!1,this.storage=[],this.typeIndexListed={uri:null,graph:null},this.typeIndexUnlisted={uri:null,graph:null},this.parsedGraph=null,this.preferences={uri:null,graph:null},this.response=r,this.relatedProfiles={sameAs:[],seeAlso:[]},this.webId=null,e&&(this.baseProfileUrl=e.indexOf("#")>=0?e.slice(0,e.indexOf("#")):e,i&&(this.initWebId(i),this.appendFromGraph(i,this.baseProfileUrl)))}function extractWebId(e,i){var r=rdf.sym(e),t=vocab.foaf("primaryTopic"),s=i.any(r,t);return s}function parseLink(e,i,r,t,s){var o=e.any(i,r,t,s);return o?o.uri:null}module.exports=SolidProfile;var rdf=require("../util/rdf-parser").rdflib,vocab=require("../vocab"),typeRegistry=require("../type-registry"),graphUtil=require("../util/graph-util"),parseLinks=graphUtil.parseLinks;SolidProfile.prototype.appendFromGraph=function(e,i){if(e){this.parsedGraph=this.parsedGraph||rdf.graph(),graphUtil.appendGraph(this.parsedGraph,e,i);var r,t=rdf.sym(this.webId);r=parseLinks(e,null,vocab.owl("sameAs")),this.relatedProfiles.sameAs=this.relatedProfiles.sameAs.concat(r),r=parseLinks(e,null,vocab.rdfs("seeAlso")),this.relatedProfiles.seeAlso=this.relatedProfiles.seeAlso.concat(r),this.preferences.uri||(this.preferences.uri=parseLink(e,t,vocab.pim("preferencesFile"))),this.inbox.uri||(this.inbox.uri=parseLink(e,t,vocab.solid("inbox"))),r=parseLinks(e,t,vocab.pim("storage")),this.storage=this.storage.concat(r),this.typeIndexListed.uri||(this.typeIndexListed.uri=parseLink(e,t,vocab.solid("publicTypeIndex"))),this.typeIndexUnlisted.uri||(this.typeIndexUnlisted.uri=parseLink(e,t,vocab.solid("privateTypeIndex")))}},SolidProfile.prototype.initWebId=function(e){if(e)try{this.webId=extractWebId(this.baseProfileUrl,e).uri}catch(i){throw new Error("Unable to parse WebID from profile: "+i)}},SolidProfile.prototype.relatedProfilesLinks=function(){var e=[];return e=e.concat(this.relatedProfiles.sameAs).concat(this.relatedProfiles.seeAlso),this.preferences.uri&&(e=e.concat(this.preferences.uri)),e},SolidProfile.prototype.hasStorage=function(){return this.storage&&this.storage.length>0},SolidProfile.prototype.loadTypeRegistry=function(e){return typeRegistry.loadTypeRegistry(this,e)},SolidProfile.prototype.addTypeRegistry=function(e,i){if(typeRegistry.isListedTypeIndex(e))this.typeIndexListed.graph||(this.typeIndexListed.uri=i,this.typeIndexListed.graph=e);else{if(!typeRegistry.isUnlistedTypeIndex(e))throw new Error("Attempting to add an invalid type registry index");this.typeIndexUnlisted.graph||(this.typeIndexUnlisted.uri=i,this.typeIndexUnlisted.graph=e)}},SolidProfile.prototype.typeRegistryForClass=function(e){return typeRegistry.typeRegistryForClass(this,e)},SolidProfile.prototype.registerType=function(e,i,r,t){return typeRegistry.registerType(this,e,i,r,t)},SolidProfile.prototype.unregisterType=function(e,i,r){return typeRegistry.unregisterType(this,e,i,r)};
},{"../type-registry":14,"../util/graph-util":15,"../util/rdf-parser":16,"../vocab":21}],11:[function(require,module,exports){
"use strict";function SolidResource(i,t){this.name=null,this.parsedGraph=null,this.response=t,this.types=[],this.uri=i,t&&t.url!==i&&(this.uri=t.url),this.initName()}module.exports=SolidResource,SolidResource.prototype.initName=function(){if(this.uri){var i=this.uri.split("/");this.name=i.pop(),!this.name&&i.length>0&&(this.name=i.pop())}},SolidResource.prototype.isContainer=function(){return!1},SolidResource.prototype.isType=function(i){return-1!==this.types.indexOf(i)};
},{}],12:[function(require,module,exports){
"use strict";function SolidResponse(e,t){if(!e)return this.xhr=null,this.user="",this.method=null,this.types=[],void(this.graph=null);var s=e.getResponseHeader("Link");this.linkHeaders=webUtil.parseLinkHeader(s)||{},t=t?t.toLowerCase():"",this.method=t,this.acl=this.linkHeaders.acl,this.acl&&(this.acl=this.acl[0]),this.allowedMethods=this.parseAllowedMethods(e,t),this.graph=null,this.meta=this.linkHeaders.meta||this.linkHeaders.describedBy,this.meta&&(this.meta=this.meta[0]),this.types=this.linkHeaders.type||[],this.url=e.getResponseHeader("Location")||e.responseURL,this.user=e.getResponseHeader("User")||"",this.websocket=e.getResponseHeader("Updates-Via")||"",this.xhr=e}module.exports=SolidResponse;var webUtil=require("../util/web-util"),graphUtil=require("../util/graph-util");SolidResponse.prototype.aclAbsoluteUrl=function e(){if(!this.acl)return this.acl;var e=webUtil.absoluteUrl(this.acl,this.url);return e},SolidResponse.prototype.contentType=function(){return this.xhr?this.xhr.getResponseHeader("Content-Type"):null},SolidResponse.prototype.exists=function(){return this.xhr&&this.xhr.status>=200&&this.xhr.status<400},SolidResponse.prototype.isContainer=function(){return this.isType("http://www.w3.org/ns/ldp#Container")||this.isType("http://www.w3.org/ns/ldp#BasicContainer")},SolidResponse.prototype.isLoggedIn=function(){return this.user},SolidResponse.prototype.isType=function(e){return-1!==this.types.indexOf(e)},SolidResponse.prototype.parseAllowedMethods=function(e,t){return"get"===t?{}:webUtil.parseAllowedMethods(e.getResponseHeader("Allow"),e.getResponseHeader("Accept-Patch"))},SolidResponse.prototype.parsedGraph=function(){return this.graph||(this.graph=graphUtil.parseGraph(this.url,this.raw(),this.contentType())),this.graph},SolidResponse.prototype.raw=function(){return this.xhr?this.xhr.response:null};
},{"../util/graph-util":15,"../util/web-util":19}],13:[function(require,module,exports){
"use strict";function isOnline(){return window.navigator.onLine}function onOffline(n){window.addEventListener("offline",n,!1)}function onOnline(n){window.addEventListener("online",n,!1)}module.exports.isOnline=isOnline,module.exports.onOffline=onOffline,module.exports.onOnline=onOnline;
},{}],14:[function(require,module,exports){
"use strict";function addToTypeIndex(e,r,t,n,i){var o,s=require("shorthash"),d=s.unique(r.uri);if(o=i?e.typeIndexListed.uri:e.typeIndexUnlisted.uri,!o)throw new Error("Cannot register type, registry URL missing");var a,u=rdf.sym(o+"#"+d);a="instance"===n?vocab.solid("instance"):vocab.solid("instanceContainer");var p=null,l=[rdf.st(u,vocab.rdf("type"),vocab.solid("TypeRegistration")).toNT(),rdf.st(u,vocab.solid("forClass"),r).toNT(),rdf.st(u,a,rdf.sym(t)).toNT()];return webClient.patch(o,p,l).then(function(){return e.loadTypeRegistry()})}function isUnlistedTypeIndex(e){return e.any(null,null,vocab.solid("UnlistedDocument"),e.uri)}function isListedTypeIndex(e){return e.any(null,null,vocab.solid("ListedDocument"),e.uri)}function loadTypeRegistry(e,r){r=r||{},r.headers=r.headers||{},r.headers.Accept||(r.headers.Accept="text/turtle");var t=[];return e.typeIndexListed.uri&&t.push(e.typeIndexListed.uri),e.typeIndexUnlisted.uri&&t.push(e.typeIndexUnlisted.uri),webClient.loadParsedGraphs(t,r).then(function(r){return r.forEach(function(r){r&&r.value&&e.addTypeRegistry(r.value,r.uri)}),e})}function registerType(e,r,t,n,i){if(!e)throw new Error("No profile provided");if(!e.isLoaded)throw new Error("Profile is not loaded");if(!r||!t)throw new Error("Type registration requires type class and location");if(n=n||"container","container"!==n&&"instance"!==n)throw new Error("Invalid location type");return loadTypeRegistry(e).then(function(e){if(i&&!e.typeIndexListed.graph)throw new Error("Profile has no Listed type index");if(!i&&!e.typeIndexUnlisted.graph)throw new Error("Profile has no Unlisted type index");return addToTypeIndex(e,r,t,n,i)})}function typeRegistryForClass(e,r){var t=[],n=!0;return t.concat(registrationsFromGraph(e.typeIndexListed.graph,r,n)).concat(registrationsFromGraph(e.typeIndexUnlisted.graph,r,!n))}function registrationsFromGraph(e,r,t){var n,i,o=[];if(!e)return o;var s=e.statementsMatching(null,null,r);return s.forEach(function(s){n=s.subject,i=e.any(n,vocab.solid("instance")),i&&o.push(new IndexRegistration(n.uri,r,"instance",i.uri,t)),i=e.any(n,vocab.solid("instanceContainer")),i&&o.push(new IndexRegistration(n.uri,r,"container",i.uri,t))}),o}function registryTriplesFor(e,r){var t=[];return e.statementsMatching(rdf.sym(r.registrationUri)).forEach(function(e){t.push(e.toNT())}),t}function removeFromTypeIndex(e,r,t,n){var i,o;if(t?(i=e.typeIndexListed.uri,o=e.typeIndexListed.graph):(i=e.typeIndexUnlisted.uri,o=e.typeIndexUnlisted.graph),!i)throw new Error("Cannot unregister type, registry URL missing");var s=registrationsFromGraph(o,r,t);if(0===s.length)return new Promise(function(r,t){r(e)});n&&(s=s.filter(function(e){return e.locationUri===n}));var d=[];s.forEach(function(e){d=d.concat(registryTriplesFor(o,e))});var a=[];return webClient.patch(i,d,a).then(function(r){return e.loadTypeRegistry()})}function unregisterType(e,r,t,n){if(!e)throw new Error("No profile provided");if(!e.isLoaded)throw new Error("Profile is not loaded");if(!r)throw new Error("Unregistering a type requires type class");return loadTypeRegistry(e).then(function(e){if(t&&!e.typeIndexListed.graph)throw new Error("Profile has no Listed type index");if(!t&&!e.typeIndexUnlisted.graph)throw new Error("Profile has no Unlisted type index");return removeFromTypeIndex(e,r,t,n)})}module.exports.loadTypeRegistry=loadTypeRegistry,module.exports.isUnlistedTypeIndex=isUnlistedTypeIndex,module.exports.isListedTypeIndex=isListedTypeIndex,module.exports.registerType=registerType,module.exports.unregisterType=unregisterType,module.exports.typeRegistryForClass=typeRegistryForClass;var IndexRegistration=require("./solid/index-registration"),rdf=require("./util/rdf-parser").rdflib,webClient=require("./web"),vocab=require("./vocab");
},{"./solid/index-registration":9,"./util/rdf-parser":16,"./vocab":21,"./web":22,"shorthash":24}],15:[function(require,module,exports){
"use strict";function appendGraph(r,e,a){e.statementsMatching(null,null,null,null).forEach(function(e){r.add(e.subject,e.predicate,e.object,e.why)})}function parseGraph(r,e,a){var n=rdf.graph();return rdf.parse(e,n,r,a),n}function parseLinks(r,e,a,n,p){var t={},s=r.statementsMatching(e,a,n,p);return s.forEach(function(r){t[r.object.uri]=!0}),Object.keys(t)}module.exports.appendGraph=appendGraph,module.exports.parseGraph=parseGraph,module.exports.parseLinks=parseLinks;var rdf=require("./rdf-parser").rdflib;
},{"./rdf-parser":16}],16:[function(require,module,exports){
"use strict";var RDFParser={};"undefined"!=typeof $rdf?RDFParser.rdflib=$rdf:"undefined"!=typeof tabulator?RDFParser.rdflib=tabulator.rdf:"undefined"!=typeof window?RDFParser.rdflib=window.$rdf:RDFParser.rdflib=require("rdflib"),module.exports=RDFParser;
},{"rdflib":undefined}],17:[function(require,module,exports){
"use strict";function rdflibNamespace(r){var e=ns(r),s=function(r){return rdf.sym(e(r))};return s}module.exports=rdflibNamespace;var rdf=require("./rdf-parser").rdflib,ns=require("rdf-ns");
},{"./rdf-parser":16,"rdf-ns":23}],18:[function(require,module,exports){
"use strict";var rdf=require("./rdf-parser").rdflib,rdflibWebClient={getParsedGraph:function(r,e,t,n){rdf.Fetcher.crossSiteProxyTemplate=e;var i=new Promise(function(e,i){var o=rdf.graph(),d=new rdf.Fetcher(o,t),s=r.indexOf("#")>=0?r.slice(0,r.indexOf("#")):r;d.nowOrWhenFetched(s,void 0,function(r,t,d){r?e(o):n?e(null):i({status:d.status,xhr:d})})},function(r){console.log("Error in getParsedGraph: %o",r)});return i}};module.exports=rdflibWebClient;
},{"./rdf-parser":16}],19:[function(require,module,exports){
"use strict";function parseAllowedMethods(e,t){var r={};if(e){var n=e.split(",");n.forEach(function(t){t&&e.indexOf(t)>=0&&(r[t.trim().toLowerCase()]=!0)})}return t&&t.indexOf("application/sparql-update")>=0&&(r.patch=!0),r}function parseLinkHeader(e){if(!e)return{};for(var t=/<[^>]*>\s*(\s*;\s*[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*")))*(,|$)/g,r=/[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*"))/g,n=e.match(t),s={},o=0;o<n.length;o++)for(var a=n[o].split(">"),l=a[0].substring(1),i=a[1],u=i.match(r),p=0;p<u.length;p++){var c=u[p],d=c.split("="),h=d[1].replace(/["']/g,"");s[h]||(s[h]=[]),s[h].push(l),s[h].length>1&&s[h].sort()}return s}function absoluteUrl(e,t){return e&&"http"!==e.slice(0,4)&&(e=t.slice(0,t.lastIndexOf("/")+1)+e),e}function composePatchQuery(e,t){var r="";return e&&e.length>0&&(e=e.map(function(e){return e.endsWith(".")&&(e=e.slice(0,-1)),e}),r+="DELETE DATA { "+e.join(" . ")+" };\n"),t&&t.length>0&&(t=t.map(function(e){return e.endsWith(".")&&(e=e.slice(0,-1)),e}),r+="INSERT DATA { "+t.join(" . ")+" };\n"),r}module.exports.composePatchQuery=composePatchQuery,module.exports.parseAllowedMethods=parseAllowedMethods,module.exports.parseLinkHeader=parseLinkHeader,module.exports.absoluteUrl=absoluteUrl;
},{}],20:[function(require,module,exports){
"use strict";var XMLHttpRequest;XMLHttpRequest="undefined"!=typeof tabulator&&tabulator.isExtension?Components.classes["@mozilla.org/xmlextras/xmlhttprequest;1"].createInstance().QueryInterface(Components.interfaces.nsIXMLHttpRequest):"undefined"!=typeof window&&"XMLHttpRequest"in window?window.XMLHttpRequest:require("xhr2"),module.exports=XMLHttpRequest;
},{"xhr2":undefined}],21:[function(require,module,exports){
"use strict";var ns=require("./util/rdflib-ns"),vocab={dct:ns("http://purl.org/dc/terms/"),foaf:ns("http://xmlns.com/foaf/0.1/"),ldp:ns("http://www.w3.org/ns/ldp#"),owl:ns("http://www.w3.org/2002/07/owl#"),pim:ns("http://www.w3.org/ns/pim/space#"),rdf:ns("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),rdfs:ns("http://www.w3.org/2000/01/rdf-schema#"),sioc:ns("http://rdfs.org/sioc/ns#"),solid:ns("http://www.w3.org/ns/solid/terms#"),vcard:ns("http://www.w3.org/2006/vcard/ns#"),xsd:ns("http://www.w3.org/2001/XMLSchema#"),acl:ns("http://www.w3.org/ns/auth/acl#")};module.exports=vocab;
},{"./util/rdflib-ns":17}],22:[function(require,module,exports){
"use strict";var config=require("../config"),graphUtil=require("./util/graph-util"),SolidResponse=require("./solid/response"),SolidContainer=require("./solid/container"),vocab=require("./vocab"),XMLHttpRequest=require("./util/xhr"),HttpError=require("standard-http-error"),SolidWebClient={createContainer:function(e,t,r,n){return this.post(e,n,t,!0)},createResponse:function(e,t){var r=new SolidResponse(e,t);return"get"===r.method&&r.isContainer()?new SolidContainer(r.location,r):r},currentUrl:function(){return"undefined"!=typeof window?window.location.href:null},needsProxy:function(e){var t=this.currentUrl(),r=t&&"https:"===t.slice(0,6),n=e&&"http:"===e.slice(0,5);return r&&n},proxyUrl:function(e,t){return t=t||config.proxyUrl,t.replace("{uri}",encodeURIComponent(e))},solidRequest:function(e,t,r,n){r=r||{},r.headers=r.headers||{},r.proxyUrl=r.proxyUrl||config.proxyUrl,r.timeout=r.timeout||config.timeout,(this.needsProxy(e)||r.forceProxy)&&(e=this.proxyUrl(e));var i=this;return new Promise(function(o,s){var u=new XMLHttpRequest;u.open(t,e),r.noCredentials||(u.withCredentials=!0);for(var a in r.headers)u.setRequestHeader(a,r.headers[a]);r.timeout&&(u.timeout=r.timeout),u.onload=function(){this.status>=200&&this.status<300?o(i.createResponse(this,t)):s(new HttpError(this.status,this.statusText,{xhr:this}))},u.onerror=function(){s(new HttpError(this.status,this.statusText,{xhr:this}))},"undefined"!=typeof n&&n?u.send(n):u.send()})},head:function(e){return this.solidRequest(e,"HEAD")},get:function(e,t){return t=t||{},t.headers=t.headers||{},t.headers.Accept||(t.headers.Accept="text/turtle;q=0.8,*/*;q=0.5"),this.solidRequest(e,"GET",t)},list:function(e,t){if(console.warn("web.list() is deprecated. Use web.get() instead."),"string"!=typeof e)throw new Error("Invalid url passed to list()");var r=""!==e,n=!e.endsWith("/");return r&&n&&(e+="/"),t=t||{},t.headers=t.headers||{},t.headers.Accept||(t.headers.Accept="text/turtle"),this.get(e,t).then(function(t){return new SolidContainer(e,t)})},loadParsedGraphs:function(e,t){var r=this,n=e.map(function(e){return r.get(e,t).then(function(t){var r=t.contentType();return graphUtil.parseGraph(e,t.raw(),r)})["catch"](function(){return null}).then(function(t){return{uri:e,value:t}})});return Promise.all(n)},options:function(e){return this.solidRequest(e,"OPTIONS")},getParsedGraph:function e(t,r,n,i){if(r=r||config.proxyUrl,n=n||config.timeout,"rdflib"!==config.parser)throw Error("Parser library not supported: "+config.parser);var e=require("./util/web-rdflib").getParsedGraph;return e(t,r,n,i)},post:function(e,t,r,n,i){var o;n?(o=vocab.ldp("BasicContainer"),i="text/turtle"):(o=vocab.ldp("Resource"),i=i||"text/turtle");var s={};return s.headers={},s.headers.Link=o+'; rel="type"',s.headers["Content-Type"]=i,r&&r.length>0&&(s.headers.Slug=r),this.solidRequest(e,"POST",s,t)},put:function(e,t,r,n){return n=n||{},n.headers=n.headers||{},n.headers["Content-Type"]=r,this.solidRequest(e,"PUT",n,t)},patch:function(e,t,r,n){var i=require("./util/web-util").composePatchQuery,o=i(t,r),s="application/sparql-update";return n=n||{},n.headers=n.headers||{},n.headers["Content-Type"]=s,this.solidRequest(e,"PATCH",n,o)},del:function(e){return this.solidRequest(e,"DELETE")}};SolidWebClient.create=SolidWebClient.post,SolidWebClient.replace=SolidWebClient.put,SolidWebClient.update=SolidWebClient.patch,module.exports=SolidWebClient;
},{"../config":1,"./solid/container":8,"./solid/response":12,"./util/graph-util":15,"./util/web-rdflib":18,"./util/web-util":19,"./util/xhr":20,"./vocab":21,"standard-http-error":28}],23:[function(require,module,exports){
"use strict";function rdfNamespace(e){return function(r){return e+r}}module.exports=rdfNamespace;
},{}],24:[function(require,module,exports){
module.exports=require("./shorthash");
},{"./shorthash":25}],25:[function(require,module,exports){
function bitwise(r){var n=0;if(0==r.length)return n;for(var t=0;t<r.length;t++){var a=r.charCodeAt(t);n=(n<<5)-n+a,n&=n}return n}function binaryTransfer(r,n){function t(r){var n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";return n[r]}n=n||62;var a,e=[],i="",o=0>r?"-":"";for(r=Math.abs(r);r>=n;)a=r%n,r=Math.floor(r/n),e.push(t(a));r>0&&e.push(t(r));for(var u=e.length-1;u>=0;u--)i+=e[u];return o+i}function unique(r){var n=binaryTransfer(bitwise(r),61);return n.replace("-","Z")}function random(r){for(var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t="",a=r||8,e=0;a>e;e++){var i=Math.floor(Math.random()*n.length);t+=n.substring(i,i+1)}return t}exports.bitwise=bitwise,exports.binaryTransfer=binaryTransfer,exports.unique=unique,exports.random=random;
},{}],26:[function(require,module,exports){
function StandardError(r,t){if(r&&"object"==typeof r?(t=r,r=void 0):this.message=r,t)for(var a in t)this[a]=t[a];has.call(this,"name")||(this.name=has.call(proto(this),"name")?this.name:this.constructor.name),!trace||"stack"in this||trace(this,this.constructor)}var has=Object.hasOwnProperty,proto=Object.getPrototypeOf,trace=Error.captureStackTrace;module.exports=StandardError,StandardError.prototype=Object.create(Error.prototype,{constructor:{value:StandardError,configurable:!0,writable:!0}}),StandardError.prototype.name="StandardError";
},{}],27:[function(require,module,exports){
module.exports={"100":"Continue","101":"Switching Protocols","102":"Processing","200":"OK","201":"Created","202":"Accepted","203":"Non-Authoritative Information","204":"No Content","205":"Reset Content","206":"Partial Content","207":"Multi-Status","208":"Already Reported","226":"IM Used","300":"Multiple Choices","301":"Moved Permanently","302":"Found","303":"See Other","304":"Not Modified","305":"Use Proxy","307":"Temporary Redirect","308":"Permanent Redirect","400":"Bad Request","401":"Unauthorized","402":"Payment Required","403":"Forbidden","404":"Not Found","405":"Method Not Allowed","406":"Not Acceptable","407":"Proxy Authentication Required","408":"Request Timeout","409":"Conflict","410":"Gone","411":"Length Required","412":"Precondition Failed","413":"Payload Too Large","414":"URI Too Long","415":"Unsupported Media Type","416":"Range Not Satisfiable","417":"Expectation Failed","418":"I'm a teapot","421":"Misdirected Request","422":"Unprocessable Entity","423":"Locked","424":"Failed Dependency","425":"Unordered Collection","426":"Upgrade Required","428":"Precondition Required","429":"Too Many Requests","431":"Request Header Fields Too Large","500":"Internal Server Error","501":"Not Implemented","502":"Bad Gateway","503":"Service Unavailable","504":"Gateway Timeout","505":"HTTP Version Not Supported","506":"Variant Also Negotiates","507":"Insufficient Storage","508":"Loop Detected","509":"Bandwidth Limit Exceeded","510":"Not Extended","511":"Network Authentication Required"}
},{}],28:[function(require,module,exports){
function HttpError(r,t,e){if("string"==typeof r&&(r=STATUS_NAME_TO_CODE[r]),"number"!=typeof r)throw new TypeError("Non-numeric HTTP code");"object"==typeof t&&null!=t&&(e=t,t=null),StandardError.call(this,t||STATUS_CODE_TO_NAME[r],e),this.code=r}function alias(r){return{configurable:!0,get:function(){return this[r]},set:function(t){return this[r]=t}}}exports=module.exports=HttpError;var StandardError=require("standard-error"),STATUS_CODE_TO_NAME=require("./codes"),STATUS_NAME_TO_CODE=exports;HttpError.prototype=Object.create(StandardError.prototype,{constructor:{value:HttpError,configurable:!0,writable:!0}}),HttpError.prototype.name="HttpError",Object.defineProperties(HttpError.prototype,{statusCode:alias("code"),statusMessage:alias("message"),status:{configurable:!0,get:function(){return this.code},set:function(r){Object.defineProperty(this,"status",{value:r,configurable:!0,enumerable:!0,writable:!0})}}}),HttpError.prototype.toString=function(){return this.name+": "+this.code+" "+this.message};for(var code in STATUS_CODE_TO_NAME){var name=STATUS_CODE_TO_NAME[code];exports[name.replace("'","").replace(/[- ]/g,"_").toUpperCase()]=+code}
},{"./codes":27,"standard-error":26}],29:[function(require,module,exports){
module.exports={"name":"solid-client","version":"0.18.0","description":"Common library for writing Solid read-write-web applications","main":"./index.js","files":["index.js","config.js","lib","dist"],"scripts":{"build-browserified":"browserify -r ./index.js:solid --exclude 'xhr2' --exclude 'rdflib' --standalone 'SolidClient' > dist/solid.js","build-minified":"browserify -r ./index.js:solid --exclude 'xhr2' --exclude 'rdflib' -d -p [minifyify --no-map] --standalone 'SolidClient' > dist/solid.min.js","build":"npm run clean && mkdir -p dist/resources && npm run standard && npm run build-browserified && npm run build-minified","build-qunit-resources":"browserify -r ./test/resources/profile-ldnode.js:test-ldnode-profile --exclude 'xhr2' --exclude 'rdflib' > dist/resources/test-ldnode-profile.js","prepublish":"npm run build","clean":"rm -rf dist/","standard":"standard lib/*","tape":"tape test/unit/*.js","test":"npm run standard && npm run tape","qunit":"npm run standard && npm run build-browserified && open test/integration/index.html"},"repository":{"type":"git","url":"https://github.com/solid/solid.js"},"keywords":["solid","decentralized","web","rdf","ldp","linked","data"],"author":"Andrei Sambra <andrei@fcns.eu>","license":"MIT","bugs":{"url":"https://github.com/solid/solid.js/issues"},"homepage":"https://github.com/solid/solid.js","dependencies":{"rdf-ns":"0.0.2","rdflib":"^0.7.0","shorthash":"0.0.2","standard-http-error":"^2.0.0","xhr2":"^0.1.3"},"devDependencies":{"blue-tape":"^0.2.0","browserify":"^13.0.0","minifyify":"^7.2.1","qunit":"^0.9.0","standard":"^5.4.1","tape":"^4.4.0"},"standard":{"globals":["$rdf","tabulator","QUnit"]}}
},{}],"solid":[function(require,module,exports){
"use strict";var Solid={acl:require("./lib/permissions/authorization").acl,auth:require("./lib/auth"),config:require("./config"),currentUser:require("./lib/auth").currentUser,getProfile:require("./lib/identity").getProfile,getPermissions:require("./lib/permissions").getPermissions,clearPermissions:require("./lib/permissions").clearPermissions,identity:require("./lib/identity"),login:require("./lib/auth").login,meta:require("./lib/meta"),signup:require("./lib/auth").signup,status:require("./lib/status"),vocab:require("./lib/vocab"),web:require("./lib/web")};module.exports=Solid;
},{"./config":1,"./lib/auth":2,"./lib/identity":3,"./lib/meta":4,"./lib/permissions":6,"./lib/permissions/authorization":5,"./lib/status":13,"./lib/vocab":21,"./lib/web":22}]},{},[])("solid")
});

